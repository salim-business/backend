(function(t){"use strict";function d(){this.settings={default_search_obj:{url:theme.routes.search_url,data:{view:"json"}},suggest_search_obj:{url:theme.routes.search_url+"/suggest.json",data:{resources:{type:theme.search_show_only_products?"product":"product,page",unavailable_products:"last",fields:"title,vendor,product_type,variants.title",options:null}}}},this.selectors={search:".js-search-ajax"},this.load()}d.prototype=t.extend({},d.prototype,{load:function(){var u=this,a="",_;function g(s,e,r){if(r.count>0){var h=t(t("#template-search-ajax")[0].content),c=t(document.createDocumentFragment()),n=+s.attr("data-js-max-products")-1;t.each(r.results,function(l){var i=h.clone(),o=i.find(".product-search-2__image img"),b=i.find(".product-search-2__title a"),f=i.find(".product-search-2__price .price"),v=i.find("a");if(v.attr("href",this.url),b.html(this.title),this.image?o.attr("srcset",Shopify.resizeImage(this.image,"200x")+" 1x, "+Shopify.resizeImage(this.image,"200x@2x")+" 2x"):o.remove(),f.length)if(this.price){switch(theme.search_result_correction){case"/100":{this.price=this.price/100,this.compare_at_price=this.compare_at_price/100;break}case"/10":{this.price=this.price/10,this.compare_at_price=this.compare_at_price/10;break}case"*10":{this.price=this.price*10,this.compare_at_price=this.compare_at_price*10;break}case"*100":{this.price=this.price*100,this.compare_at_price=this.compare_at_price*100;break}}theme.ProductPrice.insert(f,this.price,this.compare_at_price)}else f.remove();return c.append(i),l<n}),e.html(""),e.append(c),theme.LazyImage.update(),theme.MultiCurrency&&theme.MultiCurrency.update()}else e.html("");e[r.count>0?"removeClass":"addClass"]("d-none-important")}function p(s,e,r,h){var c=s.find(".search-ajax__result"),n=s.find(".search-ajax__view-all"),l=n.find("a"),i=s.find(".search-ajax__empty");l.attr("href",theme.routes.search_url+"?q="+r+"&options[prefix]=last"+(theme.search_show_only_products?"&type=product":"")),n[h.count>0?"removeClass":"addClass"]("d-none-important"),i.html(theme.strings.general.search.no_results_html.replace("{{ terms }}",r))[r===""||h.count>0?"addClass":"removeClass"]("d-none-important"),c.addClass("invisible"),g(s,c,h),c.removeClass("invisible"),theme.Preloader.unset(e),s.find('button[type="submit"]').removeClass("disabled"),s.addClass("open"),$body.unbind("click.search-ajax"),$window.unbind("scroll.search-ajax"),$body.on("click.search-ajax",function(o){t(o.target).parents(".js-search-ajax").length||(m(),$body.unbind("click.search-ajax"))}),$window.on("scroll.search-ajax",function(){m(),$window.unbind("scroll.search-ajax")})}function m(s){var e=s||t(u.selectors.search),r=e.find(".search-ajax__content");a="",e.find("input").val(""),p(e,r,a,{count:0}),e.removeClass("open")}$body.on("keyup",this.selectors.search+" input",theme.debounce(function(s){var e=t(s.target).parents(u.selectors.search);if(s.keyCode!==27){var r=t(s.target),h=r.val().replace(/<script[^>]*>(?:(?!<\/script>)[^])*<\/script>/g,"").trim(),c=e.find(".search-ajax__content");h!==a&&(a=h,a===""?p(e,c,a,{count:0}):(_&&_.abort(),theme.Preloader.set(c),e.find('button[type="submit"]').addClass("disabled"),_=t.getJSON(t.extend(!0,{},theme.search_predictive_enabled?u.settings.suggest_search_obj:u.settings.default_search_obj,{type:"GET",data:{q:a},success:function(n){var l=5,i={count:Math.min(n.resources.results.products.length+(n.resources.results.pages?n.resources.results.pages.length:0),l),results:[]},o=0;t.each(n.resources.results.products,function(){if(o>l)return!1;theme.search_predictive_enabled&&this.price_min.indexOf(".")===-1&&(this.price_min*=100),theme.search_predictive_enabled&&this.compare_at_price_min.indexOf(".")===-1&&(this.compare_at_price_min*=100),i.results.push({price:this.price_min,compare_at_price:this.compare_at_price_min,image:this.image,title:this.title,url:this.url}),o++}),t.each(n.resources.results.pages,function(){if(o>l)return!1;i.results.push({title:this.title,url:this.url,image:this.image||null}),o++}),p(e,c,a,i)}}))))}},500)),$body.on("keyup",this.selectors.search+" input",function(s){if(s.keyCode===27){var e=t(this).parents(u.selectors.search),r=e.find(".search-ajax__content");a="",p(e,r,a,{count:0})}}),$body.on("clear",this.selectors.search,function(){m(t(this))})},closeAll:function(){t(this.selectors.search+".open").trigger("clear")}}),theme.AssetsLoader.onPageLoaded(function(){theme.SearchAjax=new d})})(jQueryTheme);
//# sourceMappingURL=/s/files/1/0275/1814/0468/t/6/assets/module.search-ajax.js.map?v=72214935630234471261636677086
